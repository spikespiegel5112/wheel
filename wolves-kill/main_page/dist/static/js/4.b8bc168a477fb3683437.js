webpackJsonp([4],{"OR+C":function(t,e,s){"use strict";function i(t){s("qkBF")}Object.defineProperty(e,"__esModule",{value:!0});var o=s("mvHQ"),a=s.n(o),n=s("lbHh"),c=s.n(n),r=s("NQGu"),l={name:"wolveskill",components:{},data:function(){return{getUserInfoByTokenRequest:"uaa/user",addUserSchoolRequest:"profile-service/1.0.0/user_school/addUserSchool",check_join_activityRequest:"promotion-service/1.0.0/offline_activity/check_join_activity",participate_activityRequest:"promotion-service/1.0.0/offline_activity/participate_activity",getUserActivityInfoRequest:"promotion-service/1.0.0/offline_activity/getUserActivityInfo",voteRequest:"promotion-service/1.0.0/offline_activity/vote",fnvalleySdkInstance:{},showAddress:!1,activeTabIndex:0,participateSuccessful:!1,activityBeganFlag:!1,confirmState:"default",confirmFlag:!1,rejectFlag:!1,userInfoData:{},userSchoolName:"",voteSuccessfulFlag:!1,isVoted:!1}},computed:{channel:function(){return this.$route.query.channel||""},loginId:function(){return this.$route.query.loginId||""},tabBarWidth:function(){return 16*this.tabList[this.activeTabIndex].title.length+"px"},userActivityId:function(){return this.$route.query.userActivityId}},watch:{userInfoData:function(t){var e=this;this.$store.state.schoolList[0].filter(function(t){return t.value===e.userInfoData.userSchoolName}).length>0&&(this.userSchoolName=this.$store.state.schoolList[0].filter(function(t){return t.value===e.userInfoData.userSchoolName})[0].name)}},beforeCreate:function(){},beforeMount:function(){console.log(this.$route),this.$vux.loading.show({text:"Loading"}),"advertise"===this.$route.query.routeto?(this.$vux.loading.hide(),this.$router.push({name:"wolveskillAdvertise"})):this.redirectingFlag=!1},mounted:function(){console.log(new r.a),this.fnvalleySdkInstance=new r.a,console.log(this.redirectingFlag),this.redirectingFlag||(this.$remResizing({fontSize:20}),this.$autoHeight({target:".wolveskill_canvassdetail_wrapper"}),console.log(window),this.getUserActivityInfo())},methods:{getUserActivityInfo:function(){var t=this;this.$http.get(this.$baseUrl+this.getUserActivityInfoRequest+"/"+this.$store.state.activityId+"/"+this.$store.state.loginId,{headers:{Authorization:"Bearer "+this.$store.state.accessToken}}).then(function(e){console.log("getUserActivityInfo",e),e=e.data,t.userInfoData=e,t.$vux.loading.hide(),t.checkIsVoted()}).catch(function(e){console.log(e),t.$vux.confirm.show({showCancelButton:!1,title:"getUserActivityInfo_error"+e,onConfirm:function(){}})})},getAccessToken:function(){var t=this;this.fnvalleySdkInstance.userAccessToken().then(function(e){console.log(e),console.log("this.getAccessToken++++",e),t.accessToken=e,t.$vux.loading.hide()}).catch(function(e){console.log("this.getAccessToken error",e),t.unauthorizedFlag=!0,t.confirmState="unauthorized",t.$vux.loading.hide()})},handleTabClick:function(t){console.log(t),this.activeTabIndex=t},goBack:function(){this.$router.push({name:"homepage"})},checkIsVoted:function(){var t=this,e=[];c.a.get("wolvesKill-loginId")?(e=JSON.parse(c.a.get("wolvesKill-loginId")),this.isVoted=e.filter(function(e){return e===Number(t.loginId)}).length>0):this.isVoted=!1},vote:function(){var t=this;this.isVoted?this.$vux.confirm.show({showCancelButton:!1,title:"已投票请勿复投",onConfirm:function(){}}):this.$http.post(this.$baseUrl+this.voteRequest+"/"+this.userActivityId,{},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.$store.state.accessToken}}).then(function(e){switch(console.log(e),e.code){case 1e4:t.voteSuccessfulFlag=!0,t.getUserActivityInfo(),t.saveCache(),t.isVoted=!0}})},share:function(){console.log(this.$checkEnvironment());var t="loginId="+this.userInfoData.loginId+"$userActivityId="+this.userActivityId;this.fnvalleySdkInstance.openAPPShare({title:"投票开始！趣谷狼人杀决赛票选红人进行时！",describe:"榜单前六直接空降决赛，赢取双重丰厚双旦大礼，更有机会成为校园网红，做这条街上最靓的仔！",weburl:this.$shareDomainUrl+"?state="+t})},checkTicket:function(){var t=this;t.$router.push({name:"ticket",query:{userSchoolName:t.userInfoData.userSchoolName}})},saveCache:function(){var t=this,e=[];c.a.get("wolvesKill-loginId")?(e=JSON.parse(c.a.get("wolvesKill-loginId")),0===e.filter(function(e){return e===t.loginId}).length&&e.push(Number(this.loginId))):e.push(Number(this.loginId)),c.a.set("wolvesKill-loginId",a()(e))},editProfile:function(){this.$router.push({name:"participate",query:{state:"edit"}})}}},u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"common_main_container"},[i("div",{staticClass:"wolveskill_registrationresult_wrapper"},["wechat"===t.$checkEnvironment()?i("div",{staticClass:"common_header_wrapper"},[i("div",{staticClass:"left_wrapper"},[i("div",{staticClass:"previous"},[i("a",{on:{click:t.goBack}},[i("svg",{staticClass:"vux-x-icon vux-x-icon-ios-arrow-left",attrs:{type:"ios-arrow-left",size:"30",xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 512 512"}},[i("path",{attrs:{d:"M352 115.4L331.3 96 160 256l171.3 160 20.7-19.3L201.5 256z"}})])])])]),t._v(" "),i("div",{staticClass:"middle_wrapper"},[t._v("\n        报名结果\n      ")])]):t._e(),t._v(" "),i("div",{staticClass:"maincontainer"},[i("div",{staticClass:"wolveskill_activityname_wrapper"},[t._v("报名成功：西安高校狼人杀友谊赛S1")]),t._v(" "),i("div",{staticClass:"wolveskill_block_wrapper"},[i("h2",{staticClass:"resulttitle",on:{click:t.checkTicket}},[i("label",[t._v("活动群二维码")]),t._v(" "),t._m(0)])]),t._v(" "),i("div",{staticClass:"wolveskill_block_wrapper"},[i("h2",{staticClass:"resulttitle"},[i("label",[t._v("人气选手排名投票")]),t._v(" "),i("a",{staticClass:"link",on:{click:t.editProfile}},[t._v("\n            修改信息\n          ")])]),t._v(" "),i("div",{staticClass:"main"},[i("div",{staticClass:"userinfo_wrapper"},[i("div",{staticClass:"userimage"},[""!==t.userInfoData.userImage&&null!==t.userInfoData.userImage?i("img",{attrs:{src:t.userInfoData.userImage}}):i("img",{attrs:{src:s("zGmm")}})]),t._v(" "),i("div",{staticClass:"desc"},[i("div",{staticClass:"name"},[i("label",[t._v(t._s(t.userInfoData.userRealName))]),t._v(" "),i("span",[t._v(t._s(t.userSchoolName)+"   "+t._s(t.userInfoData.userMajor))])]),t._v(" "),i("div",{staticClass:"statistic"},[i("ul",[i("li",[i("label",[t._v(t._s(t.userInfoData.ranking))]),t._v(" "),i("span",[t._v("排名")])]),t._v(" "),i("li",[i("label",[t._v(t._s(t.userInfoData.votes))]),t._v(" "),i("span",[t._v("票数")])])])])])])]),t._v(" "),i("ul",{staticClass:"wolveskill_button_wrapper"},[i("li",[t.isVoted?i("a",{on:{click:t.vote}},[t._v("已投票")]):i("a",{on:{click:t.vote}},[t._v("投票")])]),t._v(" "),i("li",[i("a",{on:{click:t.share}},[t._v("分享拉票")])])]),t._v(" "),t._m(1)])])]),t._v(" "),i("toast",{attrs:{type:"text",time:2e3,"is-show-mask":"",text:"投票成功"},model:{value:t.voteSuccessfulFlag,callback:function(e){t.voteSuccessfulFlag=e},expression:"voteSuccessfulFlag"}})],1)},v=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("a",{staticClass:"link"},[s("span",{staticClass:"triangle"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"hint"},[s("p",[t._v("\n            榜单说明：人气榜单前8名直接获得晋级资格+晋级联赛奖励（2000积分+飞利浦蓝牙音响）\n          ")])])}],h={render:u,staticRenderFns:v},f=h,d=s("VU/8"),g=i,_=d(l,f,!1,g,"data-v-444299c2",null);e.default=_.exports},UNgs:function(t,e,s){e=t.exports=s("FZ+f")(!1),e.push([t.i,"",""])},qkBF:function(t,e,s){var i=s("UNgs");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);s("rjj0")("f2abee4a",i,!0,{})},zGmm:function(t,e,s){t.exports=s.p+"static/img/canvass_default_00000.2d8f3cd.jpg"}});