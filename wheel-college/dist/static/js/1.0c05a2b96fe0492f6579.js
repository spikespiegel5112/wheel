webpackJsonp([1],{"379A":function(e,t,i){e.exports=i.p+"static/img/prize.84b2141.png"},"9GE0":function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__("ZLEe"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__=__webpack_require__("hRKE"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__=__webpack_require__("aA9S"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__=__webpack_require__("rVsN"),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify__=__webpack_require__("3cXf"),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_5_js_cookie__=__webpack_require__("uAC3"),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_js_cookie__),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk__=__webpack_require__("efG5"),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk__),_unused_webpack_default_export={name:"Wheel",data:function(){return{getUserInfoByTokenRequest:"uaa/user",oauthTokenRequest:"uaa/oauth/token",getActivityInfoRequest:"promotion-service/1.0.0/rotary_table_activity/getActivityInfo",participate_activityRequest:"promotion-service/1.0.0/rotary_table_activity/participate_activity",verificationCodeRequest:"message-service/1.0.0/sms/verificationCode",queryRewardTraceRequest:"promotion-service/1.0.0/rotary_table_activity/queryRewardTrace",queryRewardTraceByLoginIdRequest:"promotion-service/1.0.0/rotary_table_activity/queryRewardTraceByLoginIdRequest",getSignatureRequest:"account-service/1.0.0/weChat/getSignature",participate_accept_rewardRequest:"promotion-service/1.0.0/rotary_table_activity/participate_accept_reward",get_daily_numberRequest:"promotion-service/1.0.0/activity_participate_number/get_daily_number",accessToken:"",statisticImageUrl:"",redirectingFlag:!1,initializing:!1,loading:!1,smsCodeState:!1,jsCookieInstance:__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a,redirectInfo:"",downloadUrl:"",colorDictionary:["#feebcd","#ffb54c"],textColorDictionary:["#C21515","#feebcd"],dotsColorDictionary:["#ffd800","#fe9166"],prizeTypeDictionary:[{name:"趣豆",code:"coin",unit:""},{name:"积分",code:"point",unit:""},{name:"百视通会员卡",code:"bes_tv",unit:""},{name:"third_link",code:"third_link",unit:""}],wheelData:[{name:"比萨饼",value:10,image:"https://pic5.40017.cn/01/000/79/0a/rBLkBVpVuxmAUQqmAAARnUFXcFc487.png"},{name:"酱肘子",value:20,image:"http://upload.wikimedia.org/wikipedia/commons/thumb/4/47/PNG_transparency_demonstration_1.png/280px-PNG_transparency_demonstration_1.png"},{name:"红烧肉",value:30,image:"http://pic.c-ctrip.com/platform/online/home/un_index_supply.png"},{name:"炖排骨",value:30,image:"http://resource.zan-qian.com/test/icon/1534327599157.jpeg-style_100x100"},{name:"小鸡炖蘑菇",value:30,image:"http://resource.zan-qian.com/test/icon/1534327599157.jpeg-style_100x100"},{name:"牛排",value:30,image:"http://resource.zan-qian.com/test/icon/1534327599157.jpeg-style_100x100"}],sponsor:[{name:""}],activityInfo:{},wheelCanvas:{},remUnit:0,canvasWidth:"400px",canvasHeight:"400px",canvasReadyFlag:!1,rotatingFlag:!1,verificationCode:"",rotateDuration:3e3,dialogFlag:!1,phoneNumber:"",phoneNumberReceiveFlag:!1,tokenReceiveFlag:!1,loginToGetPrizeFlag:!1,loginToGetPrizeListFlag:!1,smsCodeCountDown:0,smsCodeCountDownDuration:60,rewardRecordList:[],productToken:"",prizeData:{},alreadyReleasedPrize:!1,alreadyReceivedPrize:!1,rewardCode:"",actualRotate:0,dailyLimit:"",pageFingerPrint:"",environment:"",stateCodeData:{},openId:"",loginId:"",userInfo:{},environmentDictionary:[{name:"ios",method:"window.webkit.messageHandlers.token.postMessage('')",checker:"window.webkit",status:!1},{name:"android",method:"window.android.getToken()",checker:"window.android",status:!1},{name:"wechat",checker:"console",status:!1}],dailyTimes:0,channel:"",activityId:"",accessTokenReadyFlag:!1,testString:"xxx"}},computed:{userActivityId:function(){return this.$route.query.state},identityCode:function(){return this.$route.query.state},wechatAuthCode:function(){return console.log(this.$route),this.$route.query.code},stateCode:function(){return this.$route.query.state}},watch:{remUnit:function(e){var t=this;this.$nextTick(function(){t.canvasWidth=13.5*e+"px",t.canvasHeight=13.5*e+"px",t.getPrizeList()})},weChatAuthorityURL:function(e){console.log(e)},initializing:function(e){},alreadyReleasedPrize:function(e){this.$nextTick(function(){sessionStorage.setItem("alreadyReleasedPrize",e)})},alreadyReceivedPrize:function(e){this.$nextTick(function(){sessionStorage.setItem("alreadyReceivedPrize",e)})},rewardCode:function(e){sessionStorage.setItem("rewardCode",e)},rewardStr:function(e){sessionStorage.setItem("rewardStr",e)},prizeData:function(e){console.log("prizeData",e),sessionStorage.removeItem("prizeData"),sessionStorage.setItem("prizeData",__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify___default()(e))},dailyLimit:function(e){sessionStorage.setItem("dailyLimit",e)},redirectInfo:function(e){console.log(e),"shareredirect"===e&&location.assign("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx67c26ff8068af257&redirect_uri=http://activity.fnvalley.com/collegewheel/index.html&response_type=code&scope=snsapi_userinfo&state="+this.stateCode+"#wechat_redirect")},accessToken:function(e){""!==e&&__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-accessToken",e)},accessTokenReadyFlag:function(e){}},created:function(){this.redirectInfo=this.$route.query.routeto,this.channel=this.$route.query.channel,this.activityId=this.$route.query.activityId},beforeMount:function(){window.location.href},mounted:function(){var e=this;this.initializing=!1,this.$nextTick(function(){e.$autoHeight({target:".wheel_winningdialog_wrapper"}),e.$remResizing({fontSize:20})}),this.$nextTick(function(){e.remUnit=Number(document.getElementsByTagName("html")[0].style.fontSize.replace("px",""))}),this.getCacheData(),"wechat"===this.checkEnvironment()&&this.parseStateCode(),this.checkEnvironment(),this.getAccessToken(),this.checkUUID(),this.getRewardRecordList(),this.getStatisticImageUrl(),this.recordStatisticEvent("onLoad"),this.initJSSDK()},methods:{getAccessToken:function(){var e=this;if(this.alreadyReceivedPrize||"wechat"!==this.checkEnvironment()){var t=this;this.$nextTick(function(){if("wechat"!==e.checkEnvironment()){switch(e.checkEnvironment()){case"android":e.accessToken=window.android.getToken(),alert("android_accesstoken,"+e.accessToken),e.getLoginId();break;case"ios":window.webkit.messageHandlers.token.postMessage(""),window.getAppToken=function(e){t.$vux.confirm.show({showCancelButton:!1,title:"getAppToken+   "+e.token,onConfirm:function(){}}),t.testString=e.token,t.accessToken=e.token},getAppToken()}__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-accessToken",e.accessToken)}})}else this.getWechatToken({type:"wechat_code",params:{code:this.wechatAuthCode}}).then(function(t){console.log("this.getWechatToken",t),e.accessToken=t.access_token;var i=e;e.$http.get(e.$baseUrl+e.get_daily_numberRequest+"/"+e.activityId,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+t.access_token}}).then(function(t){console.log("get_daily_numberRequest",t),alert(t.data),e.dailyTimes=t.data}).catch(function(t){if(console.log(t),401===t.status)switch(e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效",onConfirm:function(){i.tokenReceiveFlag=!1}}),e.checkEnvironment()){case"android":case"ios":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效",onConfirm:function(){i.tokenReceiveFlag=!1,window.android.refreshToken()}})}})})},parseStateCode:function(){var e=[],t=decodeURIComponent(this.stateCode);t.split("$").forEach(function(t){e[t.split("=")[0]]=t.split("=")[1]}),this.stateCodeData=e,this.channel=e.channel,this.activityId=e.activityId,console.log("parseStateCode",e),console.log("channel",this.channel),console.log(t)},getWechatToken:function(e){var t=this;return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function(i,n){e=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default()({type:"",params:{}},e),"wechat"===t.checkEnvironment()?t.$http.post(t.$baseUrl+t.oauthTokenRequest,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default()({grant_type:e.type},e.params),{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic YW5kcm9pZDphZG1pbg=="},transformRequest:[function(e){var t="";for(var i in e)t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&";return t}]}).then(function(e){console.log("oauthTokenRequest",e),t.accessToken=e.access_token,t.getLoginId(),i(e)}).catch(function(e){switch(console.log("error",e),e.data.code){case 1:t.dialogFlag=!0,t.loginToGetPrizeFlag=!0,t.openId=e.data.openId,t.cleanCache(),n(e);break;case 2:t.cleanCache(),n(e),t.$vux.confirm.show({showCancelButton:!1,title:e.data.error+"，请关闭页面重新打开2",onConfirm:function(){}});break;case 3:t.cleanCache(),n(e),t.$vux.confirm.show({showCancelButton:!1,title:e.data.error+"，请关闭页面重新打开3",onConfirm:function(){}});break;default:t.cleanCache(),t.$vux.confirm.show({showCancelButton:!1,title:e.data.error_description,onConfirm:function(){}}),n(e)}}):alert("当前不是微信环境也不是原生环境")})},reInitializePage:function(){var e="channel="+this.loginId+"^activityId="+this.activityId;location.assign("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx67c26ff8068af257&redirect_uri="+this.$domainUrl+"&response_type=code&scope=snsapi_userinfo&state="+e+"#wechat_redirect")},getLoginId:function(){var e=this,t=this;this.$http.get(this.$baseUrl+this.getUserInfoByTokenRequest,{params:{access_token:this.accessToken},headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.accessToken}}).then(function(t){console.log(t),e.loginId=t.name,__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-loginId",e.loginId)}).catch(function(i){if(console.log(i),401===i.status)switch(e.checkEnvironment()){case"android":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效，请关闭再打开页面android",onConfirm:function(){t.tokenReceiveFlag=!1,window.android.refreshToken()}});break;case"ios":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效，请关闭再打开页面ios",onConfirm:function(){t.tokenReceiveFlag=!1,window.android.refreshToken()}})}})},getPrizeList:function(){var e=this;this.loading=!0,this.$http.get(this.$baseUrl+this.getActivityInfoRequest,{params:{activityId:this.activityId}}).then(function(t){console.log(t),e.loading=!1,t=t.data,e.wheelData=[],e.activityInfo=t.activityInfo,JSON.parse("null"===sessionStorage.getItem("dailyLimit"))&&(e.dailyLimit=t.activityInfo.dailyLimit),t.rewardList.forEach(function(t,i){e.wheelData.push({name:t.rewardName,image:null!==t.rewardImage?t.rewardImage+"-style_100x100":"",value:t.rewardStr})}),e.drawCanvas(),e.getCachedCircleNumber()}).catch(function(t){console.log(t),e.loading=!1,e.$vux.confirm.show({showCancelButton:!1,title:t.data.message,onConfirm:function(){}})})},drawPrize:function(){var e=this;this.loading=!0,this.$http.post(this.$baseUrl+this.participate_activityRequest,{},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){console.log(t),e.loading=!1;var i=t;switch(t=t.data,i.code){case 1e4:e.prizeData=t,e.rewardCode=t.rewardCode,e.wheelData.forEach(function(i,n){i.value===t.rewardStr&&e.rotateWheel(n).then(function(){e.alreadyReceivedPrize=!1,e.alreadyReleasedPrize=!0,e.dailyLimit=Number(e.dailyLimit)>0?Number(e.dailyLimit)-1:e.dailyLimit,e.rewardStr=t.rewardStr,e.$store.commit("turnOffWinningPrizeChance")})});break;case 10004:e.$vux.confirm.show({showCancelButton:!1,title:i.message,onConfirm:function(){}})}})},receivePrize:function(){this.loading=!1,this.recordStatisticEvent("receivePrize"),void 0!==__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")?(this.dialogFlag=!0,this.tokenReceiveFlag=!0):void 0!==__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")&&void 0!==__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-loginId")||(this.dialogFlag=!0,this.tokenReceiveFlag=!1)},drawAndReceivePrize:function(){""===this.accessToken&&""!==this.openId?(this.dialogFlag=!0,this.loginToGetPrizeFlag=!0):""===this.accessToken&&""===this.openId?this.$vux.confirm.show({showCancelButton:!1,title:"获取不到用户信息，请关闭页面",onConfirm:function(){}}):this.rotatingFlag||this.receivePrizeByToken()},getCachedCircleNumber:function(){if(void 0!==sessionStorage.getItem("actualRotate")&&0!==sessionStorage.getItem("actualRotate")){this.actualRotate=sessionStorage.getItem("actualRotate");var e=this.actualRotate%360;this.wheelCanvas.style.transform="rotate("+e+"deg)"}},rotateWheel:function(e){var t=this;return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function(i,n){console.log(111,e),e=t.wheelData.length-e;var o=360/t.wheelData.length;console.log(222,3600+o*e),t.actualRotate=3600+o*e,t.wheelCanvas.style.transform="rotate(-"+t.actualRotate+"deg)",sessionStorage.setItem("actualRotate",t.actualRotate),t.rotatingFlag?n():(t.rotatingFlag=!0,t.wheelCanvas.style.transition="all "+t.rotateDuration/1e3+"s ease",t.wheelCanvas.style.transform="rotate("+t.actualRotate+"deg)",setTimeout(function(){t.rotatingFlag=!1,t.wheelCanvas.style.transition="rotate 0s ease",i()},t.rotateDuration))})},validateForm:function(){var e=this;return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function(t,i){return e.phoneNumber=e.phoneNumber.replace(/(^\s*)|(\s*$)/g,""),e.verificationCode=e.verificationCode.replace(/(^\s*)|(\s*$)/g,""),""===e.phoneNumber?(e.$vux.confirm.show({showCancelButton:!1,title:"手机号未填写",onConfirm:function(){}}),void i()):!1===/^[1-9]+[0-9]*]*$/.test(e.phoneNumber)?(e.$vux.confirm.show({showCancelButton:!1,title:"手机号不是数字",onConfirm:function(){}}),void i()):!1===/^[1-9]+[0-9]*]*$/.test(e.verificationCode)?(e.$vux.confirm.show({showCancelButton:!1,title:"验证码不是数字",onConfirm:function(){}}),void i()):!1===/^\d{6}$/.test(e.verificationCode)?(e.$vux.confirm.show({showCancelButton:!1,title:"验证码不为6位数字",onConfirm:function(){}}),void i()):(""===e.verificationCode&&(e.$vux.confirm.show({showCancelButton:!1,title:"验证码未填写",onConfirm:function(){}}),i()),void t())})},receivePrizeByForm:function(){var e=this;console.log("this.channel",this.channel),this.validateForm().then(function(){e.getWechatToken({type:"sms",params:{username:e.phoneNumber,code:e.verificationCode,source:"zhinengxiaoyuan",promotionCode:"",openId:e.openId,channel:e.channel,activityId:e.activityId}}).then(function(t){e.dialogFlag=!1,e.loginToGetPrizeFlag=!1,sessionStorage.setItem("userInfo",__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify___default()(t)),e.receivePrizeByToken()})})},login:function(){var e=this;this.validateForm().then(function(){e.getWechatToken({type:"sms",params:{username:e.phoneNumber,code:e.verificationCode,source:"zhinengxiaoyuan",promotionCode:"",openId:e.openId,channel:e.channel,activityId:e.activityId}}).then(function(t){e.$http.post(e.$baseUrl+e.oauthTokenRequest,{grant_type:"sms",username:e.phoneNumber,code:e.verificationCode},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic YW5kcm9pZDphZG1pbg=="},transformRequest:[function(e){var t="";for(var i in e)t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&";return t}]}).then(function(t){console.log(t),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-accessToken",t.access_token),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-loginId",e.phoneNumber),e.$router.push({name:"myPrizeList",query:{loginId:__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-loginId"),pageNo:0,token:t.access_token}})}).catch(function(t){e.$vux.confirm.show({showCancelButton:!1,title:t.data.error_description||t.data.message,onConfirm:function(){}})})})})},receivePrizeByToken:function(){var e=this,t=this;if(this.alreadyReceivedPrize)this.$router.push({name:"acceptPrize",query:{rewardStr:this.prizeData.rewardStr}});else{if(""===this.accessToken&&void 0===this.accessToken)return;this.$http.post(this.$baseUrl+this.participate_accept_rewardRequest+"/"+this.activityId,{},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.accessToken}}).then(function(t){console.log("participate_accept_rewardRequest",t);var i=t;switch(t=t.data,i.code){case 1e4:console.log("10000",e.wheelData),e.rewardCode=t.rewardCode,e.wheelData.forEach(function(i,n){i.value===t.rewardStr&&e.rotateWheel(n).then(function(){e.alreadyReceivedPrize=!0,e.alreadyReleasedPrize=!0,e.dailyLimit=Number(e.dailyLimit)>0?Number(e.dailyLimit)-1:e.dailyLimit,e.rewardStr=t.rewardStr,e.prizeData=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default()(t,{rewardName:i.name}),e.$store.commit("turnOffWinningPrizeChance"),e.receivePrize()})});break;case 10002:case 10004:e.$vux.confirm.show({showCancelButton:!1,title:i.message,onConfirm:function(){}})}}).catch(function(i){if(console.log(i),401===i.status)switch(e.checkEnvironment()){case"android":case"ios":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效，请关闭再打开页面",onConfirm:function(){t.tokenReceiveFlag=!1,window.android.refreshToken()}})}})}},drawCanvas:function(){var e=this;console.log(this.remUnit),this.wheelCanvas=document.getElementById("wheelcanvas");var t=this.wheelCanvas.getContext("2d"),i=this.wheelCanvas.getContext("2d"),n=2*Math.PI/this.wheelData.length,o=13.5*this.remUnit,a=13.5*this.remUnit;t.font=this.remUnit,i.beginPath(),i.arc(o/2,a/2,6.75*this.remUnit,0,2*Math.PI,!0),i.fillStyle="rgba(188,75,61,0.5)",i.fill(),i.beginPath(),i.arc(o/2,a/2,6.57*this.remUnit,0,2*Math.PI,!0),i.fillStyle="#bc4b3d",i.fill(),i.beginPath(),i.arc(o/2,a/2,6.35*this.remUnit,0,2*Math.PI,!0),i.fillStyle="#f06949",i.fill(),i.save();var r=function(){for(var i=0;i<24;i++){t.beginPath();var n=2*Math.PI/24*i,r=.5*o+Math.cos(n)*e.remUnit*5.9,s=.5*a+Math.sin(n)*e.remUnit*5.9;t.arc(r,s,.35*e.remUnit,e.remUnit,2*Math.PI,!0),t.fillStyle=i%2==0?e.dotsColorDictionary[0]:e.dotsColorDictionary[1],t.fill()}};r(),setInterval(function(){r(),e.dotsColorDictionary=e.dotsColorDictionary.reverse()},1e3);var s=[];this.wheelData.forEach(function(t,i){var n=new Image;n.width="150",n.height="150",n.src=e.$replaceProtocol(e.wheelData[i].image),n.transparency=.2,s.push(n)}),this.wheelData.forEach(function(i,r){var c=n*r;e.checkLowestCommonDivisorWith2(e.wheelData.length)?c-=Math.PI:c=c-Math.PI+n,t.beginPath(),t.moveTo(o/2,a/2),t.lineWidth=3,e.checkLowestCommonDivisorWith2(e.wheelData.length)?t.arc(o/2,a/2,5.4*e.remUnit,c+n-Math.PI/e.wheelData.length,c-Math.PI/e.wheelData.length,!0):t.arc(o/2,a/2,5.4*e.remUnit,c+n,c,!0),t.lineTo(o/2,a/2),t.strokeStyle="#f06949",t.stroke(),t.fillStyle=e.colorDictionary[r%2],t.save(),t.fill(),s[r].onload=function(){var i=void 0,_=void 0;e.checkLowestCommonDivisorWith2(e.wheelData.length)?(i=.5*o+Math.cos(c+n/2-Math.PI/2-Math.PI/e.wheelData.length)*e.remUnit*5,_=.5*a+Math.sin(c+n/2-Math.PI/2-Math.PI/e.wheelData.length)*e.remUnit*5):(i=.5*o+Math.cos(c+n/2)*e.remUnit*5,_=.5*a+Math.sin(c+n/2)*e.remUnit*5),t.font=.5*e.remUnit+"px Georgia",t.fillStyle=e.textColorDictionary[r%2],t.translate(i,_),t.rotate(c+Math.PI/2+n/2),t.fillText(e.wheelData[r].name,-t.measureText(e.wheelData[r].name).width/2,22),t.drawImage(s[r],2*-e.remUnit*.5,1.3*e.remUnit,2*e.remUnit,2*e.remUnit),t.shadowColor="#000",t.shadowBlur=10,t.shadowOffsetX=0,t.shadowOffsetY=0,t.restore(),t.save()},t.restore(),t.save()}),this.getCachedCircleNumber()},sendSmsCode:function(){var e=this;if(""===this.phoneNumber)return void this.$vux.confirm.show({showCancelButton:!1,title:"请输入手机号",onConfirm:function(){}});!1===this.smsCodeState?(this.loading=!0,this.$http.get(this.$baseUrl+this.verificationCodeRequest+"/"+this.phoneNumber+"/1").then(function(t){console.log(t),e.loading=!1,!0===t.alreadySent?(e.$vux.confirm.show({showCancelButton:!1,title:"短信已发出，请查收",onConfirm:function(){}}),e.smsCodeState=!0,e.smsCodeCountDown=e.smsCodeCountDownDuration,e.smsCodeCountDown>0?setInterval(function(){0===--e.smsCodeCountDown&&(e.smsCodeState=!1,e.smsCodeCountDown=60)},1e3):e.smsCodeState=!1):e.$vux.confirm.show({showCancelButton:!1,title:t.message,onConfirm:function(){}})}).catch(function(t){console.log(t),e.$vux.confirm.show({showCancelButton:!1,title:"短信已发出，请稍后再试",onConfirm:function(){}}),e.loading=!1})):this.$vux.confirm.show({showCancelButton:!1,title:"短信已发出，请稍后再试",onConfirm:function(){}})},checkLowestCommonDivisorWith2:function(e){for(var t=!0,i=2;i<e;i++)2!==(e/=2)&&(t=e%2==0);return t},changeUser:function(){this.phoneNumber="",this.verificationCode="",this.tokenReceiveFlag=!1,__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.remove("wheel-accessToken")},getRewardRecordList:function(){var e=this;this.$http.get(this.$baseUrl+this.queryRewardTraceRequest,{params:{activityId:this.activityId}}).then(function(t){console.log("getRewardRecordList",t),t=t.data,e.rewardRecordList=t})},close:function(){this.dialogFlag=!1,this.tokenReceiveFlag=!1,this.loginToGetPrizeFlag=!1},checkAuthorized:function(){return"undefined"===__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")||void 0===__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")},loginToCheckMyPrize:function(){this.checkAuthorized()?(this.dialogFlag=!0,this.loginToGetPrizeListFlag=!0):this.$router.push({name:"myPrizeList",query:{loginId:__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-loginId"),pageNo:0}})},getCacheData:function getCacheData(){var regex=new RegExp(/(true)|(false)/);console.log(regex.test(sessionStorage.getItem("alreadyReleasedPrize"))),regex.test(sessionStorage.getItem("alreadyReleasedPrize"))&&(this.alreadyReleasedPrize=eval(sessionStorage.getItem("alreadyReleasedPrize")),this.rewardCode=sessionStorage.getItem("rewardCode"),this.rewardStr=sessionStorage.getItem("rewardStr"),this.prizeData=JSON.parse(sessionStorage.getItem("prizeData"))),regex.test(sessionStorage.getItem("alreadyReceivedPrize"))&&(this.alreadyReceivedPrize=eval(sessionStorage.getItem("alreadyReceivedPrize"))),"number"==typeof Number(sessionStorage.getItem("dailyLimit"))&&(this.dailyLimit=sessionStorage.getItem("dailyLimit")),"object"===__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(JSON.parse(sessionStorage.getItem("prizeData")))?this.alreadyReleasedPrize=eval(sessionStorage.getItem("alreadyReleasedPrize")):(console.log(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(JSON.parse(sessionStorage.getItem("prizeData"))).length>0),this.cleanCache()),"object"===__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(JSON.parse(sessionStorage.getItem("userInfo")))&&(this.userInfo=JSON.parse(sessionStorage.getItem("userInfo")))},cleanCache:function(){this.alreadyReleasedPrize=!1,this.alreadyReceivedPrize=!1,this.dialogFlag=!1,this.phoneNumberReceiveFlag=!1,this.tokenReceiveFlag=!1,setTimeout(function(){sessionStorage.removeItem("alreadyReleasedPrize"),sessionStorage.removeItem("alreadyReceivedPrize"),sessionStorage.removeItem("rewardCode"),sessionStorage.removeItem("rewardStr"),sessionStorage.removeItem("prizeData"),sessionStorage.removeItem("actualRotate"),sessionStorage.removeItem("dailyLimit"),sessionStorage.removeItem("userInfo")},500)},getStatisticImageUrl:function(){this.statisticImageUrl=this.$baseUrl+"message-service/1.0.0/statistics.jpg?source=zhinengxiaoyuan&timeStamp="+Date.parse(new Date)},recordStatisticEvent:function(e){var t=document.createElement("img");t.className="statistic",t.src=this.$baseUrl+"message-service/1.0.0/statistics.jpg?source=zhinengxiaoyuan&timeStamp="+Date.parse(new Date)+"&eventId="+e+"&webId="+this.pageFingerPrint,t.width=0,t.height=0,document.querySelector(".wheel_realpage_container").appendChild(t)},checkUUID:function(){__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-pageFingerPrint")?this.pageFingerPrint=__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-pageFingerPrint"):(this.pageFingerPrint=this.$generateUUID(),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-pageFingerPrint",this.pageFingerPrint))},initJSSDK:function(){var e=this;console.log("777",location.href.split("#")[0]),this.$http.post(this.$baseUrl+this.getSignatureRequest,{url:location.href.split("#")[0]},{headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){var t="";for(var i in e)t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&";return t}]}).then(function(t){console.log(t),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.config({debug:!1,appId:"wx67c26ff8068af257",timestamp:t.data.timestamp,nonceStr:t.data.nonceStr,signature:t.data.signature,jsApiList:["onMenuShareAppMessage","onMenuShareTimeline","hideMenuItems"]}),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.error(function(e){console.log(e),alert("wechat error")}),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.ready(function(t){console.log(t),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.checkJsApi({jsApiList:["onMenuShareAppMessage","onMenuShareTimeline"],success:function(e){alert("check")}});__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.onMenuShareTimeline({title:"免费领取奖品",link:e.$domainUrl+"/?routeto=shareredirect&state=channel",imgUrl:"http://resource.zan-qian.com/share/red_packet20180727191755.png-style_108x144",success:function(){}}),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.onMenuShareAppMessage({title:"免费领取奖品",desc:"免费领取奖品",link:e.$domainUrl+"/?routeto=shareredirect&state=channel",imgUrl:"http://resource.zan-qian.com/share/red_packet20180727191755.png-style_108x144",type:"",dataUrl:"",success:function(){}})})})},checkUserAgent:function(){var e=navigator.userAgent,t=void 0,i=e.indexOf("Android")>-1||e.indexOf("Adr")>-1,n=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),o="micromessenger"===!!e.match(/MicroMessenger/i);return t=i?"android":n?"ios":o?"wechat":"web",this.environment=t,t},checkEnvironment:function checkEnvironment(){var environment=void 0,that=this;switch(environment=this.environmentDictionary.filter(function(item){return void 0!==eval(item.checker)})[0].name,console.log("checkEnvironment",void 0===eval(that.environmentDictionary[0].checker)),this.$vux.confirm.show({showCancelButton:!1,title:"checkEnvironment+   "+eval(that.environmentDictionary[0].checker)===void 0,onConfirm:function(){}}),environment){case"ios":console.warn(environment),alert("environment+"+environment);break;case"android":case"wechat":console.warn(environment)}return this.environment=environment,environment},getAppToken:function(e){alert(e)}}}},"F/ER":function(e,t,i){"use strict";function n(e){_||i("Trrl")}Object.defineProperty(t,"__esModule",{value:!0});var o=(i("9GE0"),i("PbNv")),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"common_main_container"},[i("div",{staticClass:"content",attrs:{id:"app"}},[i("div",{staticClass:"bg"}),e._v(" "),i("div",{staticClass:"wheel_realpage_container"},[i("div",{staticClass:"header"},[i("div",{staticClass:"nav"},[i("div",{staticClass:"left"},[i("router-link",{staticClass:"a",attrs:{to:{name:"activityRules"}}},[e._v("\n                活动规则6\n              ")])],1),e._v(" "),i("div",{staticClass:"right"},[i("a",{staticClass:"a",on:{click:e.loginToCheckMyPrize}},[e._v("\n                我的奖品"+e._s(e.testString)+"\n              ")])])]),e._v(" "),i("div",{staticClass:"chance"},[e._m(0),e._v(" "),i("p",[e._v("\n              您有"),i("span",[e._v(e._s(-1!==e.dailyTimes?e.dailyTimes:"无限"))]),e._v("次领奖机会\n            ")])])]),e._v(" "),i("div",{staticClass:"wheel_wrapper"},[i("div",{staticClass:"wheel"},[i("canvas",{attrs:{id:"wheelcanvas",width:13.5*e.remUnit,height:13.5*e.remUnit}},[e._v("抱歉！浏览器不支持。")]),e._v(" "),e.alreadyReleasedPrize||e.alreadyReceivedPrize?i("a",{staticClass:"continue",on:{click:e.receivePrize}}):i("a",{staticClass:"begin",on:{click:e.drawAndReceivePrize}})]),e._v(" "),e._m(1)]),e._v(" "),e._m(2),e._v(" "),i("div",{staticClass:"winninglist"},[i("ul",e._l(e.rewardRecordList,function(t){return i("li",[i("label",[e._v("恭喜"+e._s(t.loginId.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")))]),e._v(" "),i("span",[e._v('免费获得"'+e._s(t.rewardName)+'"奖品')])])}))])]),e._v(" "),i("CommonLoading",{attrs:{loading:e.loading}})],1)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.dialogFlag,expression:"dialogFlag"}],staticClass:"wheel_winningdialog_wrapper"},[i("div",{staticClass:"login"},[e.phoneNumberReceiveFlag?i("div",{},[i("div",{staticClass:"crown"}),e._v(" "),i("div",{staticClass:"dialog_wrapper inputphonenumber"},[i("p",{staticClass:"hint"},[e._v('\n            已抽中"'+e._s(e.prizeData.rewardName)+'"'),i("br"),e._v(" "),i("span",[e._v("登录即可免费获得")])]),e._v(" "),i("div",{staticClass:"form"},[i("div",{staticClass:"inputitem"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneNumber,expression:"phoneNumber"}],staticClass:"phone",attrs:{placeholder:"请输入手机号"},domProps:{value:e.phoneNumber},on:{input:function(t){t.target.composing||(e.phoneNumber=t.target.value)}}})]),e._v(" "),i("div",{staticClass:"inputitem"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.verificationCode,expression:"verificationCode"}],staticClass:"smscode",attrs:{placeholder:"验证码"},domProps:{value:e.verificationCode},on:{input:function(t){t.target.composing||(e.verificationCode=t.target.value)}}}),e._v(" "),i("a",{staticClass:"button smscodebutton",class:{disable:e.smsCodeState},on:{click:e.sendSmsCode}},[e._v(e._s(e.smsCodeState?e.smsCodeCountDown+"s":"获取"))])]),e._v(" "),i("a",{staticClass:"button",on:{click:e.receivePrizeByForm}},[e._v("免费领取")])])])]):e._e(),e._v(" "),e.tokenReceiveFlag?i("div",{},[i("div",{staticClass:"crown"}),e._v(" "),i("div",{staticClass:"dialog_wrapper acceptprize"},[i("p",{staticClass:"hint"},[e._v('\n            已抽中"'+e._s(e.prizeData.rewardName)+'"\n          ')]),e._v(" "),e._m(3),e._v(" "),i("a",{staticClass:"button",on:{click:e.receivePrizeByToken}},[e._v("免费领取")]),e._v(" "),i("div",{staticClass:"userinfo"},[i("span",[e._v(e._s(e.jsCookieInstance.get("wheel-loginId")))])])])]):e._e(),e._v(" "),e.loginToGetPrizeFlag?i("div",{},[i("div",{staticClass:"dialog_wrapper inputphonenumber"},[i("p",{staticClass:"hint"},[e._v("\n            登 录\n          ")]),e._v(" "),i("div",{staticClass:"form"},[i("div",{staticClass:"inputitem"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneNumber,expression:"phoneNumber"}],staticClass:"phone",attrs:{placeholder:"请输入手机号"},domProps:{value:e.phoneNumber},on:{input:function(t){t.target.composing||(e.phoneNumber=t.target.value)}}})]),e._v(" "),i("div",{staticClass:"inputitem"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.verificationCode,expression:"verificationCode"}],staticClass:"smscode",attrs:{placeholder:"验证码"},domProps:{value:e.verificationCode},on:{input:function(t){t.target.composing||(e.verificationCode=t.target.value)}}}),e._v(" "),i("a",{staticClass:"button smscodebutton",class:{disable:e.smsCodeState},on:{click:e.sendSmsCode}},[e._v(e._s(e.smsCodeState?e.smsCodeCountDown+"s":"获取"))])]),e._v(" "),e.loginToGetPrizeListFlag?i("a",{staticClass:"button",on:{click:e.login}},[e._v("确定")]):i("a",{staticClass:"button",on:{click:e.receivePrizeByForm}},[e._v("确定")])])])]):e._e(),e._v(" "),i("div",{staticClass:"close"},[i("a",{on:{click:e.close}})])])])])},r=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"decoration"},[i("span",{staticClass:"left"},[i("i"),e._v(" "),i("label")]),e._v(" "),i("span",{staticClass:"right"},[i("label"),e._v(" "),i("i")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"prizechance"},[i("h1",[e._v("点击右上角“"),i("span",[e._v("分享")]),e._v("”可以额外获得领奖机会")]),e._v(" "),i("label",[e._v("每邀请一位用户参与抽奖，获得一次抽奖机会")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"common_blocktitle_item"},[i("div",[i("span"),e._v(" "),i("i")]),e._v(" "),i("p",[e._v("中奖名单")]),e._v(" "),i("div",[i("i"),e._v(" "),i("span")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"banner"},[n("img",{attrs:{src:i("379A")}})])}];a._withStripped=!0;var s={render:a,staticRenderFns:r},c=s,_=!1,l=i("C7Lr"),d=n,u=l(o.a,c,!1,d,"data-v-c14efc4a",null);u.options.__file="src/components/Wheel.vue";t.default=u.exports},"MA3+":function(e,t,i){t=e.exports=i("UTlt")(!1),t.push([e.i,"",""])},PbNv:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__("ZLEe"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__=__webpack_require__("hRKE"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__=__webpack_require__("aA9S"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__=__webpack_require__("rVsN"),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise__),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify__=__webpack_require__("3cXf"),__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_5_js_cookie__=__webpack_require__("uAC3"),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_js_cookie__),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk__=__webpack_require__("efG5"),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk__);__webpack_exports__.a={name:"Wheel",data:function(){return{getUserInfoByTokenRequest:"uaa/user",oauthTokenRequest:"uaa/oauth/token",getActivityInfoRequest:"promotion-service/1.0.0/rotary_table_activity/getActivityInfo",participate_activityRequest:"promotion-service/1.0.0/rotary_table_activity/participate_activity",verificationCodeRequest:"message-service/1.0.0/sms/verificationCode",queryRewardTraceRequest:"promotion-service/1.0.0/rotary_table_activity/queryRewardTrace",queryRewardTraceByLoginIdRequest:"promotion-service/1.0.0/rotary_table_activity/queryRewardTraceByLoginIdRequest",getSignatureRequest:"account-service/1.0.0/weChat/getSignature",participate_accept_rewardRequest:"promotion-service/1.0.0/rotary_table_activity/participate_accept_reward",get_daily_numberRequest:"promotion-service/1.0.0/activity_participate_number/get_daily_number",accessToken:"",statisticImageUrl:"",redirectingFlag:!1,initializing:!1,loading:!1,smsCodeState:!1,jsCookieInstance:__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a,redirectInfo:"",downloadUrl:"",colorDictionary:["#feebcd","#ffb54c"],textColorDictionary:["#C21515","#feebcd"],dotsColorDictionary:["#ffd800","#fe9166"],prizeTypeDictionary:[{name:"趣豆",code:"coin",unit:""},{name:"积分",code:"point",unit:""},{name:"百视通会员卡",code:"bes_tv",unit:""},{name:"third_link",code:"third_link",unit:""}],wheelData:[{name:"比萨饼",value:10,image:"https://pic5.40017.cn/01/000/79/0a/rBLkBVpVuxmAUQqmAAARnUFXcFc487.png"},{name:"酱肘子",value:20,image:"http://upload.wikimedia.org/wikipedia/commons/thumb/4/47/PNG_transparency_demonstration_1.png/280px-PNG_transparency_demonstration_1.png"},{name:"红烧肉",value:30,image:"http://pic.c-ctrip.com/platform/online/home/un_index_supply.png"},{name:"炖排骨",value:30,image:"http://resource.zan-qian.com/test/icon/1534327599157.jpeg-style_100x100"},{name:"小鸡炖蘑菇",value:30,image:"http://resource.zan-qian.com/test/icon/1534327599157.jpeg-style_100x100"},{name:"牛排",value:30,image:"http://resource.zan-qian.com/test/icon/1534327599157.jpeg-style_100x100"}],sponsor:[{name:""}],activityInfo:{},wheelCanvas:{},remUnit:0,canvasWidth:"400px",canvasHeight:"400px",canvasReadyFlag:!1,rotatingFlag:!1,verificationCode:"",rotateDuration:3e3,dialogFlag:!1,phoneNumber:"",phoneNumberReceiveFlag:!1,tokenReceiveFlag:!1,loginToGetPrizeFlag:!1,loginToGetPrizeListFlag:!1,smsCodeCountDown:0,smsCodeCountDownDuration:60,rewardRecordList:[],productToken:"",prizeData:{},alreadyReleasedPrize:!1,alreadyReceivedPrize:!1,rewardCode:"",actualRotate:0,dailyLimit:"",pageFingerPrint:"",environment:"",stateCodeData:{},openId:"",loginId:"",userInfo:{},environmentDictionary:[{name:"ios",method:"window.webkit.messageHandlers.token.postMessage('')",checker:"window.webkit",status:!1},{name:"android",method:"window.android.getToken()",checker:"window.android",status:!1},{name:"wechat",checker:"console",status:!1}],dailyTimes:0,channel:"",activityId:"",accessTokenReadyFlag:!1,testString:"xxx"}},computed:{userActivityId:function(){return this.$route.query.state},identityCode:function(){return this.$route.query.state},wechatAuthCode:function(){return console.log(this.$route),this.$route.query.code},stateCode:function(){return this.$route.query.state}},watch:{remUnit:function(e){var t=this;this.$nextTick(function(){t.canvasWidth=13.5*e+"px",t.canvasHeight=13.5*e+"px",t.getPrizeList()})},weChatAuthorityURL:function(e){console.log(e)},initializing:function(e){},alreadyReleasedPrize:function(e){this.$nextTick(function(){sessionStorage.setItem("alreadyReleasedPrize",e)})},alreadyReceivedPrize:function(e){this.$nextTick(function(){sessionStorage.setItem("alreadyReceivedPrize",e)})},rewardCode:function(e){sessionStorage.setItem("rewardCode",e)},rewardStr:function(e){sessionStorage.setItem("rewardStr",e)},prizeData:function(e){console.log("prizeData",e),sessionStorage.removeItem("prizeData"),sessionStorage.setItem("prizeData",__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify___default()(e))},dailyLimit:function(e){sessionStorage.setItem("dailyLimit",e)},redirectInfo:function(e){console.log(e),"shareredirect"===e&&location.assign("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx67c26ff8068af257&redirect_uri=http://activity.fnvalley.com/collegewheel/index.html&response_type=code&scope=snsapi_userinfo&state="+this.stateCode+"#wechat_redirect")},accessToken:function(e){""!==e&&__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-accessToken",e)},accessTokenReadyFlag:function(e){}},created:function(){this.redirectInfo=this.$route.query.routeto,this.channel=this.$route.query.channel,this.activityId=this.$route.query.activityId},beforeMount:function(){window.location.href},mounted:function(){var e=this;this.initializing=!1,this.$nextTick(function(){e.$autoHeight({target:".wheel_winningdialog_wrapper"}),e.$remResizing({fontSize:20})}),this.$nextTick(function(){e.remUnit=Number(document.getElementsByTagName("html")[0].style.fontSize.replace("px",""))}),this.getCacheData(),"wechat"===this.checkEnvironment()&&this.parseStateCode(),this.checkEnvironment(),this.getAccessToken(),this.checkUUID(),this.getRewardRecordList(),this.getStatisticImageUrl(),this.recordStatisticEvent("onLoad"),this.initJSSDK()},methods:{getAccessToken:function(){var e=this;if(this.alreadyReceivedPrize||"wechat"!==this.checkEnvironment()){var t=this;this.$nextTick(function(){if("wechat"!==e.checkEnvironment()){switch(e.checkEnvironment()){case"android":e.accessToken=window.android.getToken(),alert("android_accesstoken,"+e.accessToken),e.getLoginId();break;case"ios":window.webkit.messageHandlers.token.postMessage(""),window.getAppToken=function(e){t.$vux.confirm.show({showCancelButton:!1,title:"getAppToken+   "+e.token,onConfirm:function(){}}),t.testString=e.token,t.accessToken=e.token},getAppToken()}__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-accessToken",e.accessToken)}})}else this.getWechatToken({type:"wechat_code",params:{code:this.wechatAuthCode}}).then(function(t){console.log("this.getWechatToken",t),e.accessToken=t.access_token;var i=e;e.$http.get(e.$baseUrl+e.get_daily_numberRequest+"/"+e.activityId,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+t.access_token}}).then(function(t){console.log("get_daily_numberRequest",t),alert(t.data),e.dailyTimes=t.data}).catch(function(t){if(console.log(t),401===t.status)switch(e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效",onConfirm:function(){i.tokenReceiveFlag=!1}}),e.checkEnvironment()){case"android":case"ios":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效",onConfirm:function(){i.tokenReceiveFlag=!1,window.android.refreshToken()}})}})})},parseStateCode:function(){var e=[],t=decodeURIComponent(this.stateCode);t.split("$").forEach(function(t){e[t.split("=")[0]]=t.split("=")[1]}),this.stateCodeData=e,this.channel=e.channel,this.activityId=e.activityId,console.log("parseStateCode",e),console.log("channel",this.channel),console.log(t)},getWechatToken:function(e){var t=this;return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function(i,n){e=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default()({type:"",params:{}},e),"wechat"===t.checkEnvironment()?t.$http.post(t.$baseUrl+t.oauthTokenRequest,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default()({grant_type:e.type},e.params),{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic YW5kcm9pZDphZG1pbg=="},transformRequest:[function(e){var t="";for(var i in e)t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&";return t}]}).then(function(e){console.log("oauthTokenRequest",e),t.accessToken=e.access_token,t.getLoginId(),i(e)}).catch(function(e){switch(console.log("error",e),e.data.code){case 1:t.dialogFlag=!0,t.loginToGetPrizeFlag=!0,t.openId=e.data.openId,t.cleanCache(),n(e);break;case 2:t.cleanCache(),n(e),t.$vux.confirm.show({showCancelButton:!1,title:e.data.error+"，请关闭页面重新打开2",onConfirm:function(){}});break;case 3:t.cleanCache(),n(e),t.$vux.confirm.show({showCancelButton:!1,title:e.data.error+"，请关闭页面重新打开3",onConfirm:function(){}});break;default:t.cleanCache(),t.$vux.confirm.show({showCancelButton:!1,title:e.data.error_description,onConfirm:function(){}}),n(e)}}):alert("当前不是微信环境也不是原生环境")})},reInitializePage:function(){var e="channel="+this.loginId+"^activityId="+this.activityId;location.assign("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx67c26ff8068af257&redirect_uri="+this.$domainUrl+"&response_type=code&scope=snsapi_userinfo&state="+e+"#wechat_redirect")},getLoginId:function(){var e=this,t=this;this.$http.get(this.$baseUrl+this.getUserInfoByTokenRequest,{params:{access_token:this.accessToken},headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.accessToken}}).then(function(t){console.log(t),e.loginId=t.name,__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-loginId",e.loginId)}).catch(function(i){if(console.log(i),401===i.status)switch(e.checkEnvironment()){case"android":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效，请关闭再打开页面android",onConfirm:function(){t.tokenReceiveFlag=!1,window.android.refreshToken()}});break;case"ios":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效，请关闭再打开页面ios",onConfirm:function(){t.tokenReceiveFlag=!1,window.android.refreshToken()}})}})},getPrizeList:function(){var e=this;this.loading=!0,this.$http.get(this.$baseUrl+this.getActivityInfoRequest,{params:{activityId:this.activityId}}).then(function(t){console.log(t),e.loading=!1,t=t.data,e.wheelData=[],e.activityInfo=t.activityInfo,JSON.parse("null"===sessionStorage.getItem("dailyLimit"))&&(e.dailyLimit=t.activityInfo.dailyLimit),t.rewardList.forEach(function(t,i){e.wheelData.push({name:t.rewardName,image:null!==t.rewardImage?t.rewardImage+"-style_100x100":"",value:t.rewardStr})}),e.drawCanvas(),e.getCachedCircleNumber()}).catch(function(t){console.log(t),e.loading=!1,e.$vux.confirm.show({showCancelButton:!1,title:t.data.message,onConfirm:function(){}})})},drawPrize:function(){var e=this;this.loading=!0,this.$http.post(this.$baseUrl+this.participate_activityRequest,{},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){console.log(t),e.loading=!1;var i=t;switch(t=t.data,i.code){case 1e4:e.prizeData=t,e.rewardCode=t.rewardCode,e.wheelData.forEach(function(i,n){i.value===t.rewardStr&&e.rotateWheel(n).then(function(){e.alreadyReceivedPrize=!1,e.alreadyReleasedPrize=!0,e.dailyLimit=Number(e.dailyLimit)>0?Number(e.dailyLimit)-1:e.dailyLimit,e.rewardStr=t.rewardStr,e.$store.commit("turnOffWinningPrizeChance")})});break;case 10004:e.$vux.confirm.show({showCancelButton:!1,title:i.message,onConfirm:function(){}})}})},receivePrize:function(){this.loading=!1,this.recordStatisticEvent("receivePrize"),void 0!==__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")?(this.dialogFlag=!0,this.tokenReceiveFlag=!0):void 0!==__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")&&void 0!==__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-loginId")||(this.dialogFlag=!0,this.tokenReceiveFlag=!1)},drawAndReceivePrize:function(){""===this.accessToken&&""!==this.openId?(this.dialogFlag=!0,this.loginToGetPrizeFlag=!0):""===this.accessToken&&""===this.openId?this.$vux.confirm.show({showCancelButton:!1,title:"获取不到用户信息，请关闭页面",onConfirm:function(){}}):this.rotatingFlag||this.receivePrizeByToken()},getCachedCircleNumber:function(){if(void 0!==sessionStorage.getItem("actualRotate")&&0!==sessionStorage.getItem("actualRotate")){this.actualRotate=sessionStorage.getItem("actualRotate");var e=this.actualRotate%360;this.wheelCanvas.style.transform="rotate("+e+"deg)"}},rotateWheel:function(e){var t=this;return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function(i,n){console.log(111,e),e=t.wheelData.length-e;var o=360/t.wheelData.length;console.log(222,3600+o*e),t.actualRotate=3600+o*e,t.wheelCanvas.style.transform="rotate(-"+t.actualRotate+"deg)",sessionStorage.setItem("actualRotate",t.actualRotate),t.rotatingFlag?n():(t.rotatingFlag=!0,t.wheelCanvas.style.transition="all "+t.rotateDuration/1e3+"s ease",t.wheelCanvas.style.transform="rotate("+t.actualRotate+"deg)",setTimeout(function(){t.rotatingFlag=!1,t.wheelCanvas.style.transition="rotate 0s ease",i()},t.rotateDuration))})},validateForm:function(){var e=this;return new __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_promise___default.a(function(t,i){return e.phoneNumber=e.phoneNumber.replace(/(^\s*)|(\s*$)/g,""),e.verificationCode=e.verificationCode.replace(/(^\s*)|(\s*$)/g,""),""===e.phoneNumber?(e.$vux.confirm.show({showCancelButton:!1,title:"手机号未填写",onConfirm:function(){}}),void i()):!1===/^[1-9]+[0-9]*]*$/.test(e.phoneNumber)?(e.$vux.confirm.show({showCancelButton:!1,title:"手机号不是数字",onConfirm:function(){}}),void i()):!1===/^[1-9]+[0-9]*]*$/.test(e.verificationCode)?(e.$vux.confirm.show({showCancelButton:!1,title:"验证码不是数字",onConfirm:function(){}}),void i()):!1===/^\d{6}$/.test(e.verificationCode)?(e.$vux.confirm.show({showCancelButton:!1,title:"验证码不为6位数字",onConfirm:function(){}}),void i()):(""===e.verificationCode&&(e.$vux.confirm.show({showCancelButton:!1,title:"验证码未填写",onConfirm:function(){}}),i()),void t())})},receivePrizeByForm:function(){var e=this;console.log("this.channel",this.channel),this.validateForm().then(function(){e.getWechatToken({type:"sms",params:{username:e.phoneNumber,code:e.verificationCode,source:"zhinengxiaoyuan",promotionCode:"",openId:e.openId,channel:e.channel,activityId:e.activityId}}).then(function(t){e.dialogFlag=!1,e.loginToGetPrizeFlag=!1,sessionStorage.setItem("userInfo",__WEBPACK_IMPORTED_MODULE_4_babel_runtime_core_js_json_stringify___default()(t)),e.receivePrizeByToken()})})},login:function(){var e=this;this.validateForm().then(function(){e.getWechatToken({type:"sms",params:{username:e.phoneNumber,code:e.verificationCode,source:"zhinengxiaoyuan",promotionCode:"",openId:e.openId,channel:e.channel,activityId:e.activityId}}).then(function(t){e.$http.post(e.$baseUrl+e.oauthTokenRequest,{grant_type:"sms",username:e.phoneNumber,code:e.verificationCode},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic YW5kcm9pZDphZG1pbg=="},transformRequest:[function(e){var t="";for(var i in e)t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&";return t}]}).then(function(t){console.log(t),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-accessToken",t.access_token),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-loginId",e.phoneNumber),e.$router.push({name:"myPrizeList",query:{loginId:__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-loginId"),pageNo:0,token:t.access_token}})}).catch(function(t){e.$vux.confirm.show({showCancelButton:!1,title:t.data.error_description||t.data.message,onConfirm:function(){}})})})})},receivePrizeByToken:function(){var e=this,t=this;if(this.alreadyReceivedPrize)this.$router.push({name:"acceptPrize",query:{rewardStr:this.prizeData.rewardStr}});else{if(""===this.accessToken&&void 0===this.accessToken)return;this.$http.post(this.$baseUrl+this.participate_accept_rewardRequest+"/"+this.activityId,{},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.accessToken}}).then(function(t){console.log("participate_accept_rewardRequest",t);var i=t;switch(t=t.data,i.code){case 1e4:console.log("10000",e.wheelData),e.rewardCode=t.rewardCode,e.wheelData.forEach(function(i,n){i.value===t.rewardStr&&e.rotateWheel(n).then(function(){e.alreadyReceivedPrize=!0,e.alreadyReleasedPrize=!0,e.dailyLimit=Number(e.dailyLimit)>0?Number(e.dailyLimit)-1:e.dailyLimit,e.rewardStr=t.rewardStr,e.prizeData=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_assign___default()(t,{rewardName:i.name}),e.$store.commit("turnOffWinningPrizeChance"),e.receivePrize()})});break;case 10002:case 10004:e.$vux.confirm.show({showCancelButton:!1,title:i.message,onConfirm:function(){}})}}).catch(function(i){if(console.log(i),401===i.status)switch(e.checkEnvironment()){case"android":case"ios":e.$vux.confirm.show({showCancelButton:!1,title:"当前登录信息已失效，请关闭再打开页面",onConfirm:function(){t.tokenReceiveFlag=!1,window.android.refreshToken()}})}})}},drawCanvas:function(){var e=this;console.log(this.remUnit),this.wheelCanvas=document.getElementById("wheelcanvas");var t=this.wheelCanvas.getContext("2d"),i=this.wheelCanvas.getContext("2d"),n=2*Math.PI/this.wheelData.length,o=13.5*this.remUnit,a=13.5*this.remUnit;t.font=this.remUnit,i.beginPath(),i.arc(o/2,a/2,6.75*this.remUnit,0,2*Math.PI,!0),i.fillStyle="rgba(188,75,61,0.5)",i.fill(),i.beginPath(),i.arc(o/2,a/2,6.57*this.remUnit,0,2*Math.PI,!0),i.fillStyle="#bc4b3d",i.fill(),i.beginPath(),i.arc(o/2,a/2,6.35*this.remUnit,0,2*Math.PI,!0),i.fillStyle="#f06949",i.fill(),i.save();var r=function(){for(var i=0;i<24;i++){t.beginPath();var n=2*Math.PI/24*i,r=.5*o+Math.cos(n)*e.remUnit*5.9,s=.5*a+Math.sin(n)*e.remUnit*5.9;t.arc(r,s,.35*e.remUnit,e.remUnit,2*Math.PI,!0),t.fillStyle=i%2==0?e.dotsColorDictionary[0]:e.dotsColorDictionary[1],t.fill()}};r(),setInterval(function(){r(),e.dotsColorDictionary=e.dotsColorDictionary.reverse()},1e3);var s=[];this.wheelData.forEach(function(t,i){var n=new Image;n.width="150",n.height="150",n.src=e.$replaceProtocol(e.wheelData[i].image),n.transparency=.2,s.push(n)}),this.wheelData.forEach(function(i,r){var c=n*r;e.checkLowestCommonDivisorWith2(e.wheelData.length)?c-=Math.PI:c=c-Math.PI+n,t.beginPath(),t.moveTo(o/2,a/2),t.lineWidth=3,e.checkLowestCommonDivisorWith2(e.wheelData.length)?t.arc(o/2,a/2,5.4*e.remUnit,c+n-Math.PI/e.wheelData.length,c-Math.PI/e.wheelData.length,!0):t.arc(o/2,a/2,5.4*e.remUnit,c+n,c,!0),t.lineTo(o/2,a/2),t.strokeStyle="#f06949",t.stroke(),t.fillStyle=e.colorDictionary[r%2],t.save(),t.fill(),s[r].onload=function(){var i=void 0,_=void 0;e.checkLowestCommonDivisorWith2(e.wheelData.length)?(i=.5*o+Math.cos(c+n/2-Math.PI/2-Math.PI/e.wheelData.length)*e.remUnit*5,_=.5*a+Math.sin(c+n/2-Math.PI/2-Math.PI/e.wheelData.length)*e.remUnit*5):(i=.5*o+Math.cos(c+n/2)*e.remUnit*5,_=.5*a+Math.sin(c+n/2)*e.remUnit*5),t.font=.5*e.remUnit+"px Georgia",t.fillStyle=e.textColorDictionary[r%2],t.translate(i,_),t.rotate(c+Math.PI/2+n/2),t.fillText(e.wheelData[r].name,-t.measureText(e.wheelData[r].name).width/2,22),t.drawImage(s[r],2*-e.remUnit*.5,1.3*e.remUnit,2*e.remUnit,2*e.remUnit),t.shadowColor="#000",t.shadowBlur=10,t.shadowOffsetX=0,t.shadowOffsetY=0,t.restore(),t.save()},t.restore(),t.save()}),this.getCachedCircleNumber()},sendSmsCode:function(){var e=this;if(""===this.phoneNumber)return void this.$vux.confirm.show({showCancelButton:!1,title:"请输入手机号",onConfirm:function(){}});!1===this.smsCodeState?(this.loading=!0,this.$http.get(this.$baseUrl+this.verificationCodeRequest+"/"+this.phoneNumber+"/1").then(function(t){console.log(t),e.loading=!1,!0===t.alreadySent?(e.$vux.confirm.show({showCancelButton:!1,title:"短信已发出，请查收",onConfirm:function(){}}),e.smsCodeState=!0,e.smsCodeCountDown=e.smsCodeCountDownDuration,e.smsCodeCountDown>0?setInterval(function(){0===--e.smsCodeCountDown&&(e.smsCodeState=!1,e.smsCodeCountDown=60)},1e3):e.smsCodeState=!1):e.$vux.confirm.show({showCancelButton:!1,title:t.message,onConfirm:function(){}})}).catch(function(t){console.log(t),e.$vux.confirm.show({showCancelButton:!1,title:"短信已发出，请稍后再试",onConfirm:function(){}}),e.loading=!1})):this.$vux.confirm.show({showCancelButton:!1,title:"短信已发出，请稍后再试",onConfirm:function(){}})},checkLowestCommonDivisorWith2:function(e){for(var t=!0,i=2;i<e;i++)2!==(e/=2)&&(t=e%2==0);return t},changeUser:function(){this.phoneNumber="",this.verificationCode="",this.tokenReceiveFlag=!1,__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.remove("wheel-accessToken")},getRewardRecordList:function(){var e=this;this.$http.get(this.$baseUrl+this.queryRewardTraceRequest,{params:{activityId:this.activityId}}).then(function(t){console.log("getRewardRecordList",t),t=t.data,e.rewardRecordList=t})},close:function(){this.dialogFlag=!1,this.tokenReceiveFlag=!1,this.loginToGetPrizeFlag=!1},checkAuthorized:function(){return"undefined"===__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")||void 0===__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-accessToken")},loginToCheckMyPrize:function(){this.checkAuthorized()?(this.dialogFlag=!0,this.loginToGetPrizeListFlag=!0):this.$router.push({name:"myPrizeList",query:{loginId:__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-loginId"),pageNo:0}})},getCacheData:function getCacheData(){var regex=new RegExp(/(true)|(false)/);console.log(regex.test(sessionStorage.getItem("alreadyReleasedPrize"))),regex.test(sessionStorage.getItem("alreadyReleasedPrize"))&&(this.alreadyReleasedPrize=eval(sessionStorage.getItem("alreadyReleasedPrize")),this.rewardCode=sessionStorage.getItem("rewardCode"),this.rewardStr=sessionStorage.getItem("rewardStr"),this.prizeData=JSON.parse(sessionStorage.getItem("prizeData"))),regex.test(sessionStorage.getItem("alreadyReceivedPrize"))&&(this.alreadyReceivedPrize=eval(sessionStorage.getItem("alreadyReceivedPrize"))),"number"==typeof Number(sessionStorage.getItem("dailyLimit"))&&(this.dailyLimit=sessionStorage.getItem("dailyLimit")),"object"===__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(JSON.parse(sessionStorage.getItem("prizeData")))?this.alreadyReleasedPrize=eval(sessionStorage.getItem("alreadyReleasedPrize")):(console.log(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(JSON.parse(sessionStorage.getItem("prizeData"))).length>0),this.cleanCache()),"object"===__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(JSON.parse(sessionStorage.getItem("userInfo")))&&(this.userInfo=JSON.parse(sessionStorage.getItem("userInfo")))},cleanCache:function(){this.alreadyReleasedPrize=!1,this.alreadyReceivedPrize=!1,this.dialogFlag=!1,this.phoneNumberReceiveFlag=!1,this.tokenReceiveFlag=!1,setTimeout(function(){sessionStorage.removeItem("alreadyReleasedPrize"),sessionStorage.removeItem("alreadyReceivedPrize"),sessionStorage.removeItem("rewardCode"),sessionStorage.removeItem("rewardStr"),sessionStorage.removeItem("prizeData"),sessionStorage.removeItem("actualRotate"),sessionStorage.removeItem("dailyLimit"),sessionStorage.removeItem("userInfo")},500)},getStatisticImageUrl:function(){this.statisticImageUrl=this.$baseUrl+"message-service/1.0.0/statistics.jpg?source=zhinengxiaoyuan&timeStamp="+Date.parse(new Date)},recordStatisticEvent:function(e){var t=document.createElement("img");t.className="statistic",t.src=this.$baseUrl+"message-service/1.0.0/statistics.jpg?source=zhinengxiaoyuan&timeStamp="+Date.parse(new Date)+"&eventId="+e+"&webId="+this.pageFingerPrint,t.width=0,t.height=0,document.querySelector(".wheel_realpage_container").appendChild(t)},checkUUID:function(){__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-pageFingerPrint")?this.pageFingerPrint=__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.get("wheel-pageFingerPrint"):(this.pageFingerPrint=this.$generateUUID(),__WEBPACK_IMPORTED_MODULE_5_js_cookie___default.a.set("wheel-pageFingerPrint",this.pageFingerPrint))},initJSSDK:function(){var e=this;console.log("777",location.href.split("#")[0]),this.$http.post(this.$baseUrl+this.getSignatureRequest,{url:location.href.split("#")[0]},{headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){var t="";for(var i in e)t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i])+"&";return t}]}).then(function(t){console.log(t),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.config({debug:!1,appId:"wx67c26ff8068af257",timestamp:t.data.timestamp,nonceStr:t.data.nonceStr,signature:t.data.signature,jsApiList:["onMenuShareAppMessage","onMenuShareTimeline","hideMenuItems"]}),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.error(function(e){console.log(e),alert("wechat error")}),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.ready(function(t){console.log(t),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.checkJsApi({jsApiList:["onMenuShareAppMessage","onMenuShareTimeline"],success:function(e){alert("check")}});__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.onMenuShareTimeline({title:"免费领取奖品",link:e.$domainUrl+"/?routeto=shareredirect&state=channel",imgUrl:"http://resource.zan-qian.com/share/red_packet20180727191755.png-style_108x144",success:function(){}}),__WEBPACK_IMPORTED_MODULE_6_weixin_js_sdk___default.a.onMenuShareAppMessage({title:"免费领取奖品",desc:"免费领取奖品",link:e.$domainUrl+"/?routeto=shareredirect&state=channel",imgUrl:"http://resource.zan-qian.com/share/red_packet20180727191755.png-style_108x144",type:"",dataUrl:"",success:function(){}})})})},checkUserAgent:function(){var e=navigator.userAgent,t=void 0,i=e.indexOf("Android")>-1||e.indexOf("Adr")>-1,n=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),o="micromessenger"===!!e.match(/MicroMessenger/i);return t=i?"android":n?"ios":o?"wechat":"web",this.environment=t,t},checkEnvironment:function checkEnvironment(){var environment=void 0,that=this;switch(environment=this.environmentDictionary.filter(function(item){return void 0!==eval(item.checker)})[0].name,console.log("checkEnvironment",void 0===eval(that.environmentDictionary[0].checker)),this.$vux.confirm.show({showCancelButton:!1,title:"checkEnvironment+   "+eval(that.environmentDictionary[0].checker)===void 0,onConfirm:function(){}}),environment){case"ios":console.warn(environment),alert("environment+"+environment);break;case"android":case"wechat":console.warn(environment)}return this.environment=environment,environment},getAppToken:function(e){alert(e)}}}},Trrl:function(e,t,i){var n=i("MA3+");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("FIqI")("0dde223e",n,!1,{})},efG5:function(e,t){!function(t,i){e.exports=function(e,t){function i(t,i,n){e.WeixinJSBridge?WeixinJSBridge.invoke(t,o(i),function(e){s(t,e,n)}):l(t,n)}function n(t,i,n){e.WeixinJSBridge?WeixinJSBridge.on(t,function(e){n&&n.trigger&&n.trigger(e),s(t,e,i)}):n?l(t,n):l(t,i)}function o(e){return e=e||{},e.appId=M.appId,e.verifyAppId=M.appId,e.verifySignType="sha1",e.verifyTimestamp=M.timestamp+"",e.verifyNonceStr=M.nonceStr,e.verifySignature=M.signature,e}function a(e){return{timeStamp:e.timestamp+"",nonceStr:e.nonceStr,package:e.package,paySign:e.paySign,signType:e.signType||"SHA1"}}function r(e){return e.postalCode=e.addressPostalCode,delete e.addressPostalCode,e.provinceName=e.proviceFirstStageName,delete e.proviceFirstStageName,e.cityName=e.addressCitySecondStageName,delete e.addressCitySecondStageName,e.countryName=e.addressCountiesThirdStageName,delete e.addressCountiesThirdStageName,e.detailInfo=e.addressDetailInfo,delete e.addressDetailInfo,e}function s(e,t,i){"openEnterpriseChat"==e&&(t.errCode=t.err_code),delete t.err_code,delete t.err_desc,delete t.err_detail;var n=t.errMsg;n||(n=t.err_msg,delete t.err_msg,n=c(e,n),t.errMsg=n),(i=i||{})._complete&&(i._complete(t),delete i._complete),n=t.errMsg||"",M.debug&&!i.isInnerInvoke&&alert(JSON.stringify(t));var o=n.indexOf(":");switch(n.substring(o+1)){case"ok":i.success&&i.success(t);break;case"cancel":i.cancel&&i.cancel(t);break;default:i.fail&&i.fail(t)}i.complete&&i.complete(t)}function c(e,t){var i=e,n=p[i];n&&(i=n);var o="ok";if(t){var a=t.indexOf(":");"confirm"==(o=t.substring(a+1))&&(o="ok"),"failed"==o&&(o="fail"),-1!=o.indexOf("failed_")&&(o=o.substring(7)),-1!=o.indexOf("fail_")&&(o=o.substring(5)),"access denied"!=(o=(o=o.replace(/_/g," ")).toLowerCase())&&"no permission to execute"!=o||(o="permission denied"),"config"==i&&"function not exist"==o&&(o="ok"),""==o&&(o="fail")}return t=i+":"+o}function _(e){if(e){for(var t=0,i=e.length;t<i;++t){var n=e[t],o=f[n];o&&(e[t]=o)}return e}}function l(e,t){if(!(!M.debug||t&&t.isInnerInvoke)){var i=p[e];i&&(e=i),t&&t._complete&&delete t._complete,console.log('"'+e+'",',t||"")}}function d(e){if(!(I||k||M.debug||b<"6.0.2"||R.systemType<0)){var t=new Image;R.appId=M.appId,R.initTime=T.initEndTime-T.initStartTime,R.preVerifyTime=T.preVerifyEndTime-T.preVerifyStartTime,x.getNetworkType({isInnerInvoke:!0,success:function(e){R.networkType=e.networkType;var i="https://open.weixin.qq.com/sdk/report?v="+R.version+"&o="+R.isPreVerifyOk+"&s="+R.systemType+"&c="+R.clientVersion+"&a="+R.appId+"&n="+R.networkType+"&i="+R.initTime+"&p="+R.preVerifyTime+"&u="+R.url;t.src=i}})}}function u(){return(new Date).getTime()}function h(t){P&&(e.WeixinJSBridge?"preInject"===v.__wxjsjs__isPreInject?v.addEventListener&&v.addEventListener("WeixinJSBridgeReady",t,!1):t():v.addEventListener&&v.addEventListener("WeixinJSBridgeReady",t,!1))}function m(){x.invoke||(x.invoke=function(t,i,n){e.WeixinJSBridge&&WeixinJSBridge.invoke(t,o(i),n)},x.on=function(t,i){e.WeixinJSBridge&&WeixinJSBridge.on(t,i)})}function g(e){if("string"==typeof e&&e.length>0){var t=e.split("?")[0],i=e.split("?")[1];return t+=".html",void 0!==i?t+"?"+i:t}}if(!e.jWeixin){var f={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress"},p=function(){var e={};for(var t in f)e[f[t]]=t;return e}(),v=e.document,w=v.title,C=navigator.userAgent.toLowerCase(),y=navigator.platform.toLowerCase(),I=!(!y.match("mac")&&!y.match("win")),k=-1!=C.indexOf("wxdebugger"),P=-1!=C.indexOf("micromessenger"),E=-1!=C.indexOf("android"),D=-1!=C.indexOf("iphone")||-1!=C.indexOf("ipad"),b=function(){var e=C.match(/micromessenger\/(\d+\.\d+\.\d+)/)||C.match(/micromessenger\/(\d+\.\d+)/);return e?e[1]:""}(),T={initStartTime:u(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},R={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",isPreVerifyOk:1,systemType:D?1:E?2:-1,clientVersion:b,url:encodeURIComponent(location.href)},M={},S={_completes:[]},O={state:0,data:{}};h(function(){T.initEndTime=u()});var U=!1,L=[],x={config:function(e){M=e,l("config",e);var t=!1!==M.check;h(function(){if(t)i(f.config,{verifyJsApiList:_(M.jsApiList)},function(){S._complete=function(e){T.preVerifyEndTime=u(),O.state=1,O.data=e},S.success=function(e){R.isPreVerifyOk=0},S.fail=function(e){S._fail?S._fail(e):O.state=-1};var e=S._completes;return e.push(function(){d()}),S.complete=function(t){for(var i=0,n=e.length;i<n;++i)e[i]();S._completes=[]},S}()),T.preVerifyStartTime=u();else{O.state=1;for(var e=S._completes,n=0,o=e.length;n<o;++n)e[n]();S._completes=[]}}),m()},ready:function(e){0!=O.state?e():(S._completes.push(e),!P&&M.debug&&e())},error:function(e){b<"6.0.2"||(-1==O.state?e(O.data):S._fail=e)},checkJsApi:function(e){var t=function(e){var t=e.checkResult;for(var i in t){var n=p[i];n&&(t[n]=t[i],delete t[i])}return e};i("checkJsApi",{jsApiList:_(e.jsApiList)},(e._complete=function(e){if(E){var i=e.checkResult;i&&(e.checkResult=JSON.parse(i))}e=t(e)},e))},onMenuShareTimeline:function(e){n(f.onMenuShareTimeline,{complete:function(){i("shareTimeline",{title:e.title||w,desc:e.title||w,img_url:e.imgUrl||"",link:e.link||location.href,type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareAppMessage:function(e){n(f.onMenuShareAppMessage,{complete:function(){i("sendAppMessage",{title:e.title||w,desc:e.desc||"",link:e.link||location.href,img_url:e.imgUrl||"",type:e.type||"link",data_url:e.dataUrl||""},e)}},e)},onMenuShareQQ:function(e){n(f.onMenuShareQQ,{complete:function(){i("shareQQ",{title:e.title||w,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareWeibo:function(e){n(f.onMenuShareWeibo,{complete:function(){i("shareWeiboApp",{title:e.title||w,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},onMenuShareQZone:function(e){n(f.onMenuShareQZone,{complete:function(){i("shareQZone",{title:e.title||w,desc:e.desc||"",img_url:e.imgUrl||"",link:e.link||location.href},e)}},e)},startRecord:function(e){i("startRecord",{},e)},stopRecord:function(e){i("stopRecord",{},e)},onVoiceRecordEnd:function(e){n("onVoiceRecordEnd",e)},playVoice:function(e){i("playVoice",{localId:e.localId},e)},pauseVoice:function(e){i("pauseVoice",{localId:e.localId},e)},stopVoice:function(e){i("stopVoice",{localId:e.localId},e)},onVoicePlayEnd:function(e){n("onVoicePlayEnd",e)},uploadVoice:function(e){i("uploadVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadVoice:function(e){i("downloadVoice",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},translateVoice:function(e){i("translateVoice",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},chooseImage:function(e){i("chooseImage",{scene:"1|2",count:e.count||9,sizeType:e.sizeType||["original","compressed"],sourceType:e.sourceType||["album","camera"]},(e._complete=function(e){if(E){var t=e.localIds;t&&(e.localIds=JSON.parse(t))}},e))},getLocation:function(e){},previewImage:function(e){i(f.previewImage,{current:e.current,urls:e.urls},e)},uploadImage:function(e){i("uploadImage",{localId:e.localId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},downloadImage:function(e){i("downloadImage",{serverId:e.serverId,isShowProgressTips:0==e.isShowProgressTips?0:1},e)},getLocalImgData:function(e){!1===U?(U=!0,i("getLocalImgData",{localId:e.localId},(e._complete=function(e){if(U=!1,L.length>0){var t=L.shift();x.getLocalImgData(t)}},e))):L.push(e)},getNetworkType:function(e){var t=function(e){var t=e.errMsg;e.errMsg="getNetworkType:ok";var i=e.subtype;if(delete e.subtype,i)e.networkType=i;else{var n=t.indexOf(":"),o=t.substring(n+1);switch(o){case"wifi":case"edge":case"wwan":e.networkType=o;break;default:e.errMsg="getNetworkType:fail"}}return e};i("getNetworkType",{},(e._complete=function(e){e=t(e)},e))},openLocation:function(e){i("openLocation",{latitude:e.latitude,longitude:e.longitude,name:e.name||"",address:e.address||"",scale:e.scale||28,infoUrl:e.infoUrl||""},e)},getLocation:function(e){e=e||{},i(f.getLocation,{type:e.type||"wgs84"},(e._complete=function(e){delete e.type},e))},hideOptionMenu:function(e){i("hideOptionMenu",{},e)},showOptionMenu:function(e){i("showOptionMenu",{},e)},closeWindow:function(e){i("closeWindow",{},e=e||{})},hideMenuItems:function(e){i("hideMenuItems",{menuList:e.menuList},e)},showMenuItems:function(e){i("showMenuItems",{menuList:e.menuList},e)},hideAllNonBaseMenuItem:function(e){i("hideAllNonBaseMenuItem",{},e)},showAllNonBaseMenuItem:function(e){i("showAllNonBaseMenuItem",{},e)},scanQRCode:function(e){i("scanQRCode",{needResult:(e=e||{}).needResult||0,scanType:e.scanType||["qrCode","barCode"]},(e._complete=function(e){if(D){var t=e.resultStr;if(t){var i=JSON.parse(t);e.resultStr=i&&i.scan_code&&i.scan_code.scan_result}}},e))},openAddress:function(e){i(f.openAddress,{},(e._complete=function(e){e=r(e)},e))},openProductSpecificView:function(e){i(f.openProductSpecificView,{pid:e.productId,view_type:e.viewType||0,ext_info:e.extInfo},e)},addCard:function(e){for(var t=e.cardList,n=[],o=0,a=t.length;o<a;++o){var r=t[o],s={card_id:r.cardId,card_ext:r.cardExt};n.push(s)}i(f.addCard,{card_list:n},(e._complete=function(e){var t=e.card_list;if(t){for(var i=0,n=(t=JSON.parse(t)).length;i<n;++i){var o=t[i];o.cardId=o.card_id,o.cardExt=o.card_ext,o.isSuccess=!!o.is_succ,delete o.card_id,delete o.card_ext,delete o.is_succ}e.cardList=t,delete e.card_list}},e))},chooseCard:function(e){i("chooseCard",{app_id:M.appId,location_id:e.shopId||"",sign_type:e.signType||"SHA1",card_id:e.cardId||"",card_type:e.cardType||"",card_sign:e.cardSign,time_stamp:e.timestamp+"",nonce_str:e.nonceStr},(e._complete=function(e){e.cardList=e.choose_card_info,delete e.choose_card_info},e))},openCard:function(e){for(var t=e.cardList,n=[],o=0,a=t.length;o<a;++o){var r=t[o],s={card_id:r.cardId,code:r.code};n.push(s)}i(f.openCard,{card_list:n},e)},consumeAndShareCard:function(e){i(f.consumeAndShareCard,{consumedCardId:e.cardId,consumedCode:e.code},e)},chooseWXPay:function(e){i(f.chooseWXPay,a(e),e)},openEnterpriseRedPacket:function(e){i(f.openEnterpriseRedPacket,a(e),e)},startSearchBeacons:function(e){i(f.startSearchBeacons,{ticket:e.ticket},e)},stopSearchBeacons:function(e){i(f.stopSearchBeacons,{},e)},onSearchBeacons:function(e){n(f.onSearchBeacons,e)},openEnterpriseChat:function(e){i("openEnterpriseChat",{useridlist:e.userIds,chatname:e.groupName},e)},launchMiniProgram:function(e){i("launchMiniProgram",{targetAppId:e.targetAppId,path:g(e.path),envVersion:e.envVersion},e)},miniProgram:{navigateBack:function(e){e=e||{},h(function(){i("invokeMiniProgramAPI",{name:"navigateBack",arg:{delta:e.delta||1}},e)})},navigateTo:function(e){h(function(){i("invokeMiniProgramAPI",{name:"navigateTo",arg:{url:e.url}},e)})},redirectTo:function(e){h(function(){i("invokeMiniProgramAPI",{name:"redirectTo",arg:{url:e.url}},e)})},switchTab:function(e){h(function(){i("invokeMiniProgramAPI",{name:"switchTab",arg:{url:e.url}},e)})},reLaunch:function(e){h(function(){i("invokeMiniProgramAPI",{name:"reLaunch",arg:{url:e.url}},e)})},postMessage:function(e){h(function(){i("invokeMiniProgramAPI",{name:"postMessage",arg:e.data||{}},e)})},getEnv:function(t){h(function(){t({miniprogram:"miniprogram"===e.__wxjs_environment})})}}},B=1,A={};return v.addEventListener("error",function(e){if(!E){var t=e.target,i=t.tagName,n=t.src;if(("IMG"==i||"VIDEO"==i||"AUDIO"==i||"SOURCE"==i)&&-1!=n.indexOf("wxlocalresource://")){e.preventDefault(),e.stopPropagation();var o=t["wx-id"];if(o||(o=B++,t["wx-id"]=o),A[o])return;A[o]=!0,x.ready(function(){x.getLocalImgData({localId:n,success:function(e){t.src=e.localData}})})}}},!0),v.addEventListener("load",function(e){if(!E){var t=e.target,i=t.tagName;if(t.src,"IMG"==i||"VIDEO"==i||"AUDIO"==i||"SOURCE"==i){var n=t["wx-id"];n&&(A[n]=!1)}}},!0),t&&(e.wx=e.jWeixin=x),x}}(t)}(window)}});